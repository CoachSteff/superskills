# ğŸš¨ Critical Patch Release - v2.2.1

**All v2.2.0 users should upgrade immediately**

This patch release fixes 4 critical bugs discovered in post-release testing that prevented core functionality from working.

---

## ğŸ› Critical Fixes

### 1ï¸âƒ£ Model 404 Errors - All Prompt Skills Broken âœ…

**Problem:** Claude 3.5 Sonnet/Haiku models deprecated by Anthropic  
**Impact:** All 30 prompt-based skills failed with 404 errors  

**Fixed by updating model aliases to Claude Sonnet 4:**
```python
# Before
'claude-3-sonnet-latest': 'claude-3-5-sonnet-20241022'  # âŒ 404 error

# After  
'claude-3-sonnet-latest': 'claude-sonnet-4-20250514'   # âœ… Works
```

**Test:**
```bash
superskills call researcher "test query"
# âœ… No 404 error, uses latest Claude Sonnet 4
```

---

### 2ï¸âƒ£ Workflow Detection Bug - Workflows Not Found âœ…

**Problem:** Personal workflows invisible to CLI  
**Impact:** `superskills workflow list` returned empty despite workflows existing

**Fixed by extending workflow scanner to detect folder-based workflows:**
```python
# Now scans workflows/{name}/workflow.yaml pattern
workflows_root = get_workflows_dir()
for workflow_folder in workflows_root.iterdir():
    workflow_file = workflow_folder / 'workflow.yaml'
```

**Test:**
```bash
superskills workflow list
# âœ… Shows all workflows including user workflows
```

---

### 3ï¸âƒ£ Discovery Scoring - Plural Queries Failed âœ…

**Problem:** Plural query forms returned poor relevance scores  
**Impact:** `discover --query "podcasts"` scored 11.00 (should be ~78.00)

**Fixed by adding bidirectional synonym mappings:**
```python
synonyms = {
    'podcast': ['audio', 'voice', 'podcasts'],  # Added plural
    'podcasts': ['podcast', 'audio', 'voice'],  # New entry
}
```

**Test:**
```bash
superskills discover --query "podcasts"
# âœ… narrator scores 70.00 (correct relevance)
```

---

### 4ï¸âƒ£ Documentation Inaccuracy - Wrong CLI Syntax âœ…

**Problem:** Documentation showed `--json` flag (doesn't exist)  
**Impact:** Users copying examples got "unrecognized arguments" errors

**Fixed by correcting 29 instances across documentation:**
```bash
# Before (didn't work)
superskills call author "test" --json

# After (works correctly)
superskills call author "test" --format json
```

---

## ğŸ“¦ Installation & Upgrade

### New Installation
```bash
pipx install superskills
```

### Upgrade from v2.2.0
```bash
pipx upgrade superskills

# Verify
superskills --version
# Expected: 2.2.1
```

### Post-Upgrade Verification
```bash
# 1. Test model fix (should work without 404)
superskills call researcher "test query"

# 2. Test workflow detection (should show workflows)
superskills workflow list

# 3. Test discovery scoring (should score ~70.00)
superskills discover --query "podcasts"

# 4. Test JSON output (should work)
superskills call author "test" --format json
```

---

## ğŸ“Š What's Fixed

| Issue | Severity | Impact | Status |
|-------|----------|--------|--------|
| Model 404 errors | ğŸ”´ CRITICAL | 30 skills broken | âœ… Fixed |
| Workflow detection | ğŸ”´ CRITICAL | User workflows invisible | âœ… Fixed |
| Discovery plural forms | ğŸŸ¡ MEDIUM | Poor search results | âœ… Fixed |
| Documentation syntax | ğŸŸ¡ MEDIUM | Copy-paste errors | âœ… Fixed |

---

## ğŸ”„ Files Changed (7 total)

1. `cli/utils/model_resolver.py` - Updated model aliases to Claude Sonnet 4
2. `cli/core/workflow_engine.py` - Extended workflow scanner for folder-based workflows  
3. `cli/commands/discover.py` - Added plural form synonym mappings
4. `README.md` - Corrected 5 instances of `--json` â†’ `--format json`
5. `docs/IDE_INTEGRATION.md` - Corrected 24 instances of `--json` â†’ `--format json`
6. `CHANGELOG.md` - Added detailed v2.2.1 entry
7. `pyproject.toml` - Version bump to 2.2.1

**Full Changelog:** https://github.com/CoachSteff/superskills/blob/master/CHANGELOG.md#221---2024-12-20

---

## âœ… Testing Summary

All fixes verified through comprehensive testing:

```bash
âœ… Model resolution: All aliases â†’ claude-sonnet-4-20250514
âœ… Workflow detection: 5 workflows found (including user workflows)
âœ… Discovery scoring: Plural/singular forms score equivalently
âœ… Documentation: Zero --json instances remain, all examples work
âœ… No regressions: All existing functionality maintained
```

---

## ğŸš€ Migration Notes

**No action required beyond upgrade.** This is a drop-in replacement for v2.2.0.

- âœ… No breaking changes
- âœ… No API changes  
- âœ… No configuration changes
- âœ… 100% backward compatible

---

## ğŸ“ Release Assets

- **Source code** (auto-generated by GitHub)
- **PyPI package**: https://pypi.org/project/superskills/2.2.1/

Install directly from PyPI:
```bash
pip install superskills==2.2.1
```

---

## ğŸ”— Links

- ğŸ“– **Documentation**: https://github.com/CoachSteff/superskills#readme
- ğŸ“‹ **Changelog**: https://github.com/CoachSteff/superskills/blob/master/CHANGELOG.md
- ğŸ› **Issues**: https://github.com/CoachSteff/superskills/issues
- ğŸ’¬ **Discussions**: https://github.com/CoachSteff/superskills/discussions

---

## ğŸ™ Credits

This release addresses issues identified through comprehensive automated testing. Special thanks to the testing process that caught these critical bugs before widespread adoption.

---

## ğŸ“ Support

Encountering issues? 

1. Check the [Troubleshooting Guide](https://github.com/CoachSteff/superskills/blob/master/docs/QUICKSTART.md#troubleshooting)
2. Search [existing issues](https://github.com/CoachSteff/superskills/issues)
3. [Open a new issue](https://github.com/CoachSteff/superskills/issues/new) with:
   - Output of `superskills --version`
   - Full error message  
   - Command you ran
   - Expected vs actual behavior

---

**Upgrade now:** `pipx upgrade superskills`
